(function(b){var d=function(f){var e=new XMLHttpRequest();e.addEventListener("load",function(){f.success(e.response)},false);e.open("GET",f.file,true);e.responseType="arraybuffer";e.send()};var a=function(){return{register:function(e){this.callback=e.callback;this.context=e.context},execute:function(){if(this.callback){this.callback.call(this.context)}}}};var c=function(e){if(!e){throw"You need to pass a value as parameter!"}this._cachedVariabes(e);this._load()};c.prototype={_validateFormat:function(){var e=/\.(mp3|opus|ogg|wav|m4a|weba)$/;var f=e.test(this.file);if(!f){throw"The format of the audio file is invalid!"}},_createInstance:function(){var f=b.AudioContext||b.webkitAudioContext||null;var e=f;if(!e){throw"Your browser does not support API AudioContext!"}this.audioContext=new f},_cachedVariabes:function(f){this._createInstance();var e=typeof f==="string";if(e){this.file=f}else{this.file=f.file;this.autoPlay=f.autoPlay;this.loop=f.loop||false;this.volume=f.volume||1}this._validateFormat();this.callbackManager=new a()},_load:function(){var e=this;d({file:this.file,success:function(f){e._decodeAudioData.call(e,f)}})},_decodeAudioData:function(e){var f=this;var g=this.audioContext;g.decodeAudioData(e,function(h){f.source=g.createBufferSource();f.source.buffer=h;f.source.connect(g.destination);f.source.gain.value=f.volume;if(f.autoPlay||f.shouldPlay){f.callbackManager.register({callback:f._play,context:f});f.callbackManager.execute()}},function(){throw"Decoding the audio buffer failed!"})},_play:function(){this.source.loop=this.loop;this.source.start(0);this.isStarted=true},play:function(){this.callbackManager.register({callback:this._play,context:this});this.shouldPlay=true},stop:function(){if(this.isStarted){this.source.stop(0);this.isStarted=false}}};b.audioJS=function(e){return new c(e)}}(this));